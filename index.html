<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wm Discador</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    font-family:'Poppins',sans-serif;
    background:#f4f6f9;
    color:#333;
    padding-bottom:80px;
  }
  header{
    display:flex;align-items:center;justify-content:space-between;
    padding:16px 32px;background:#fff;border-bottom:2px solid #e5e7eb;
  }
  .logo-box{display:flex;align-items:center;gap:16px}
  .logo-box img{height:60px}
  header h1{font-size:26px;color:#003366;font-weight:600}
  #top-bar{
    display:flex;flex-wrap:wrap;align-items:center;gap:12px;
    padding:16px 32px;background:#fafafa;border-bottom:1px solid #ddd;
  }
  button{
    display:inline-flex;align-items:center;gap:6px;
    padding:10px 18px;border:none;border-radius:8px;font-weight:600;
    font-size:14px;cursor:pointer;transition:.25s;white-space:nowrap;
  }
  button:hover{opacity:.9;transform:translateY(-2px)}
  .btn-ligar{background:#dc3545;color:#fff}
  .btn-whats{background:#25D366;color:#fff}
  .btn-salvar{background:#ff9800;color:#fff}
  .btn-backup{background:#007bff;color:#fff}
  .btn-reset{background:#6c757d;color:#fff}
  .btn-acoes{background:#f1f3f5;color:#333}
  input[type="text"],select,textarea{
    padding:9px 12px;border:1px solid #ccc;border-radius:8px;font-size:14px
  }
  textarea{resize:vertical}
  #contador{padding:16px 32px;font-weight:600;color:#444}
  .contato-card{
    background:#fff;margin:16px 32px;border-radius:10px;
    box-shadow:0 1px 4px rgba(0,0,0,.08);padding:18px 22px
  }
  .contato-top{
    display:flex;flex-wrap:wrap;align-items:center;gap:12px;margin-bottom:10px
  }
  .contato-top span.nome{font-weight:600;min-width:230px}
  .contato-top span.numero{color:#555}
  .formulario{margin-top:10px;display:grid;gap:8px}
  .formulario select,.formulario textarea{border:1px solid #ccc;border-radius:8px;font-size:14px;padding:8px}
  h2.section{margin:32px 32px 8px;font-size:22px;color:#003366}
  table{width:calc(100% - 64px);margin:0 32px 32px;border-collapse:collapse}
  thead{background:#003366;color:#fff}
  th,td{padding:10px;border:1px solid #d1d5db;font-size:14px;text-align:left}
  tbody tr:nth-child(even){background:#f9fafb}
  footer{
    position:fixed;bottom:0;width:100%;padding:14px;
    background:#003366;color:#fff;text-align:center;font-size:13px
  }
  </style>
</head>
<body>

<header>
  <div class="logo-box">
    <img src="logo.png" alt="WM Logo">
    <h1>Wm Discador</h1>
  </div>
  <button class="btn-reset" onclick="resetGeral()">üîÑ Reset Geral</button>
</header>

<div id="top-bar">
  <input type="file" id="fileInput" accept=".csv,.txt">
  <textarea id="pasteInput" placeholder="üìã Cole aqui a lista de contatos (Nome, N√∫mero)" rows="3" style="width:280px;"></textarea>
  <button class="btn-acoes" onclick="importarColado()">üì• Importar colados</button>

  <input type="text" id="filtroNome" placeholder="üîç Filtrar nome">
  <select id="filtroLead">
    <option value="">Todos os leads</option>
    <option value="Quente">üî• Quente</option>
    <option value="Frio">‚ùÑÔ∏è Frio</option>
    <option value="Aguardando">‚è≥ Aguardando</option>
  </select>
  <button class="btn-acoes" onclick="limparFiltros()">üßπ Limpar Filtros</button>
  <button class="btn-backup" onclick="exportarCSV()">üíæ Backup</button>
</div>

<p id="contador">üìä Contatos feitos hoje: 0</p>

<div id="lista-contatos"></div>

<h2 class="section">üìú Hist√≥rico de Liga√ß√µes</h2>
<table id="contatos-feitos">
  <thead><tr><th>Nome</th><th>N√∫mero</th><th>Status</th><th>Informa√ß√µes</th><th>Lead</th><th>Data/Hora</th></tr></thead>
  <tbody></tbody>
</table>

<footer>¬© 2025 WM Assessoria ‚Äì Todos os direitos reservados.</footer>

<script>
let contatos=[];
document.getElementById("fileInput").addEventListener("change",importarArquivo);

function importarArquivo(e){
  const f=e.target.files[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=ev=>{
    const linhas=ev.target.result.split(/\r?\n/).slice(1);
    contatos=linhas.map(l=>{
      const[nome,numero]=l.split(/,|;/);
      return{nome:nome?.trim(),numero:numero?.trim()};
    }).filter(c=>c.nome&&c.numero);
    renderizarContatos();
  };
  r.readAsText(f);
}

function importarColado(){
  const texto=document.getElementById("pasteInput").value.trim();
  if(!texto)return;
  texto.split(/\r?\n/).forEach(l=>{
    const p=l.split(/,|;/);
    if(p.length>=2) contatos.push({nome:p[0].trim(),numero:p[1].trim()});
  });
  document.getElementById("pasteInput").value="";
  renderizarContatos();
}

function renderizarContatos(){
  const lista=document.getElementById("lista-contatos");
  lista.innerHTML="";
  contatos.forEach((c)=>{
    const card=document.createElement("div");
    card.className="contato-card";

    const top=document.createElement("div");
    top.className="contato-top";
    top.innerHTML=`<span class="nome">${c.nome}</span><span class="numero">${c.numero}</span>`;

    const whats=document.createElement("button");
    whats.className="btn-whats";
    whats.textContent="üí¨ WhatsApp";
    whats.onclick=()=>{
      const msg=`Ol√°, ${c.nome}`;
      window.open(`https://wa.me/55${c.numero}?text=${encodeURIComponent(msg)}`,"_blank");

      // >>> √öNICA ALTERA√á√ÉO <<<
      // Move o contato para o fim da fila ap√≥s clicar no WhatsApp
      const pos = contatos.findIndex(x => x.numero === c.numero);
      if (pos > -1) {
        const lead = contatos.splice(pos, 1)[0];
        contatos.push(lead);
        renderizarContatos();
      }
    };

    top.appendChild(whats);
    card.appendChild(top);
    lista.appendChild(card);
  });
}

function exportarCSV(){}
function limparFiltros(){}
function resetGeral(){
  if(confirm("Apagar tudo?")){
    contatos=[];
    localStorage.clear();
    renderizarContatos();
  }
}
</script>

</body>
</html>
